VARIABLE DECLARATIONS
	ALPHANUMERIC - I-CAMPGROUND, I-SITE-L, I-DATE, I-LNAME, I-FNAME, I-CCTYPE
	NUMERIC - I-LEN-STAY, I-AMT, I-CCNUM, I-CCEXP, I-SITE-N.

MAIN
	INIT
	WHILE MORE-RECS = "YES"
		MAINLINE
	CLOSING

INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	REQUEST SYSTEM DATE
	GET I-DATE
	O-DATE = I-DATE
	READ
	HEADINGS
	ERR-HEADINGS

MAINLINE
	PERFORM VALIDATION THRU 2100-X.
	IF ERR-SW = "NO"
		PERFORM CALCS
		PERFORM OUTPUT
	ELSE
		PERFORM ERR-ROUT
	 	C-ERR-COUNT++
	PERFORM READ.

VALIDATION
	MOVE "YES" TO ERR-SW
	IF VAL-CAMP
		MOVE "CAMPGROUND MUST BE (BUCK CREEK, HONEY CREEK, OR ISLAND VIEW)" TO O-ERR
	ELSE
		IF I-SITE-L NOT = ALPHABETIC
			MOVE "THE FIRST CHARACTER OF SITE MUST BE ALPHABETIC" TO O-ERR.
		IF I-SITE-N NOT = NUMERIC
			MOVE "THE SECOND AND THIRD CHARACTER OF SITE MUST BE NUMERIC" TO O-ERR.
		IF I-SITE-N < 0
			MOVE "SITE NUMBER MUST BE GREATER THAN 0" TO O-ERR.
		IF I-DATE NOT = NUMERIC
			MOVE "DATE MUST BE NUMERIC" TO O-ERR.
		IF I-DATE
			MOVE "POP TYPE MUST BE A NUMBER FROM 1 TO 6." TO O-ERR.
		IF I-LEN-STAY < 1 OR I-LEN-STAY > 12
			MOVE "LENGTH OF STAY MUST BE BETWEEN 1 AND 12." TO O-ERR.
		IF I-FNAME = SPACES
			MOVE "FIRST NAME REQUIRED." TO O-ERR.
		IF I-LNAME = SPACES
			MOVE "LAST NAME REQUIRED." TO O-ERR.
		IF I-AMT NOT = NUMERIC
			MOVE "I-AMT MUST BE NUMERIC TO O-ERR.".
		IF I-AMT NOT = SITE
			MOVE "I-AMT MUST BE CORRECT BASED ON THE SITE.".
		IF
		IF O-ERR = SPACES
			MOVE "NO" TO ERR-SW.

2100-X
	EXIT.

CALCS
		IF A 31 MONTH
		ADD I-DATE to I-LEN-STAY GIVING END-DATE
		IF VAL-31-DAY
			ADD 1 TO MONTH
			SUBTRACT 31 FROM DAY
			IF VAL-MONTH
				ADD 1 TO YEAR
				SUBTRACT 12 FROM MONTH.


OUTPUT
	PRINT DETAIL LINE O-LNAME, O-FNAME, O-CITY, O-STATE, O-ZIP, O-POP-TYPE, O-QTY, O-DEPOSIT-AMT, O-TOT-SALES.
		AT EOP
			CALL HEADINGS.
	PRINT BLANK LINE.

ERR-ROUT
	PRINT ERROR-LINE TO ERR-FILE ERR-REC, O-ERR
		AT EOP
			CALL ERROR-HEADINGS.

ERROR-HEADINGS
	C-ERR-PCTR += 1
	O-ERR-PCTR = C-PCTR
	PRINT TITLE LINE
	PRINT DIVISION LINE
	PRINT REPORT LINE
	PRINT BLANK LINE
	PRINT ERROR COLUMN HEADING LINE
	PRINT BLANK LINE

CLOSING
	GRANDTOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE

GRANDTOTALS
	O-GT-QTY-COKE = C-GT-QTY-COKE
	O-GT-QTY-DTCOKE = C-GT-QTY-DTCOKE
	O-GT-QTY-MELLOW = C-GT-QTY-MELLOW
	O-GT-QTY-CHERRY-COKE = C-GT-QTY-CHERRY-COKE
	O-GT-QTY-CHERRY-DTCOKE = C-GT-QTY-CHERRY-DTCOKE
	O-GT-QTY-SPRITE = C-GT-QTY-SPRITE
	O-GT-TEAM-A = C-GT-TEAM-A
	O-GT-TEAM-B = C-GT-TEAM-B
	O-GT-TEAM-C = C-GT-TEAM-C
	O-GT-TEAM-D = C-GT-TEAM-D
	O-GT-TEAM-E = C-GT-TEAM-E
	O-ERR-COUNT = C-ERR-COUNT

	PERFORM HEADINGS
		AFTER ADVANCING 1 PAGE.
	PRINT GRAND TOTAL LINE O-GT-QTY-COKE, O-GT-QTY-DTCOKE, O-GT-QTY-MELLOW, O-GT-QTY-CHERRY-COKE, O-GT-QTY-CHERRY-DTCOKE, O-GT-QTY-SPRITE
		O-GT-TEAM-A, O-GT-TEAM-B, O-GT-TEAM-C, O-GT-TEAM-D, O-GT-TEAM-E.

	PRINT ERROR-TOTAL LINE O-ERR-COUNT.

READ
	READ RECORD, I-LNAME, I-FNAME, I-ADDRESS, I-CITY, I-STATE, I-ZIP, I-POP-TYPE, I-#CASES, I-TEAM
	IF END OF FILE
		MORE-RECTS = "NO"
HEADINGS
	C-PCTR += 1
	O-PCTR = C-PCTR
	PRINT TITLE LINE
	DIVISION LINE
	REPORT LINE
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE
	PRINT BLANK LINE
